!function(e){Ember.libraries.register("Ember Simple Auth OAuth 2.0","0.7.0");var t,r;!function(){var e={},n={};t=function(t,r,n){e[t]={deps:r,callback:n}},r=function(t){function i(e){if("."!==e.charAt(0))return e;for(var r=e.split("/"),n=t.split("/").slice(0,-1),i=0,s=r.length;s>i;i++){var o=r[i];if(".."===o)n.pop();else{if("."===o)continue;n.push(o)}}return n.join("/")}if(n.hasOwnProperty(t))return n[t];if(n[t]={},!e[t])throw new Error("Could not find module "+t);for(var s,o=e[t],a=o.deps,u=o.callback,h=[],c=0,l=a.length;l>c;c++)h.push("exports"===a[c]?s={}:r(i(a[c])));var f=u.apply(this,h);return n[t]=s||f},r.registry=e}(),t("simple-auth-oauth2/authenticators/oauth2",["simple-auth/authenticators/base","./../configuration","exports"],function(e,t,r){"use strict";var n=e["default"],i=t["default"];r["default"]=n.extend({serverTokenEndpoint:"/token",serverTokenRevocationEndpoint:null,refreshAccessTokens:!0,_refreshTokenTimeout:null,init:function(){this.serverTokenEndpoint=i.serverTokenEndpoint,this.serverTokenRevocationEndpoint=i.serverTokenRevocationEndpoint,this.refreshAccessTokens=i.refreshAccessTokens},restore:function(e){var t=this;return new Ember.RSVP.Promise(function(r,n){var i=(new Date).getTime();!Ember.isEmpty(e.expires_at)&&e.expires_at<i?t.refreshAccessTokens?t.refreshAccessToken(e.expires_in,e.refresh_token).then(function(e){r(e)},n):n():Ember.isEmpty(e.access_token)?n():(t.scheduleAccessTokenRefresh(e.expires_in,e.expires_at,e.refresh_token),r(e))})},authenticate:function(e){var t=this;return new Ember.RSVP.Promise(function(r,n){var i={grant_type:"password",username:e.identification,password:e.password};t.makeRequest(t.serverTokenEndpoint,i).then(function(e){Ember.run(function(){var n=t.absolutizeExpirationTime(e.expires_in);t.scheduleAccessTokenRefresh(e.expires_in,n,e.refresh_token),Ember.isEmpty(n)||(e=Ember.merge(e,{expires_at:n})),r(e)})},function(e){Ember.run(function(){n(e.responseJSON||e.responseText)})})})},invalidate:function(e){function t(e){Ember.run.cancel(r._refreshTokenTimeout),delete r._refreshTokenTimeout,e()}var r=this;return new Ember.RSVP.Promise(function(n){if(Ember.isEmpty(r.serverTokenRevocationEndpoint))t(n);else{var i=[];Ember.A(["access_token","refresh_token"]).forEach(function(t){Ember.isEmpty(e[t])||i.push(r.makeRequest(r.serverTokenRevocationEndpoint,{token_type_hint:t,token:e[t]}))}),Ember.$.when.apply(Ember.$,i).always(function(){t(n)})}})},makeRequest:function(e,t){return Ember.$.ajax({url:e,type:"POST",data:t,dataType:"json",contentType:"application/x-www-form-urlencoded"})},scheduleAccessTokenRefresh:function(e,t,r){if(this.refreshAccessTokens){var n=(new Date).getTime();Ember.isEmpty(t)&&!Ember.isEmpty(e)&&(t=new Date(n+1e3*e).getTime());var i=1e3*(Math.floor(5*Math.random())+5);!Ember.isEmpty(r)&&!Ember.isEmpty(t)&&t>n-i&&(Ember.run.cancel(this._refreshTokenTimeout),delete this._refreshTokenTimeout,Ember.testing||(this._refreshTokenTimeout=Ember.run.later(this,this.refreshAccessToken,e,r,t-n-i)))}},refreshAccessToken:function(e,t){var r=this,n={grant_type:"refresh_token",refresh_token:t};return new Ember.RSVP.Promise(function(i,s){r.makeRequest(r.serverTokenEndpoint,n).then(function(n){Ember.run(function(){e=n.expires_in||e,t=n.refresh_token||t;var s=r.absolutizeExpirationTime(e),o=Ember.merge(n,{expires_in:e,expires_at:s,refresh_token:t});r.scheduleAccessTokenRefresh(e,null,t),r.trigger("sessionDataUpdated",o),i(o)})},function(e,t,r){Ember.Logger.warn("Access token could not be refreshed - server responded with "+r+"."),s()})})},absolutizeExpirationTime:function(e){return Ember.isEmpty(e)?void 0:new Date((new Date).getTime()+1e3*e).getTime()}})}),t("simple-auth-oauth2/authorizers/oauth2",["simple-auth/authorizers/base","exports"],function(e,t){"use strict";var r=e["default"];t["default"]=r.extend({authorize:function(e){var t=this.get("session.access_token");this.get("session.isAuthenticated")&&!Ember.isEmpty(t)&&e.setRequestHeader("Authorization","Bearer "+t)}})}),t("simple-auth-oauth2/configuration",["simple-auth/utils/load-config","exports"],function(e,t){"use strict";var r=e["default"],n={serverTokenEndpoint:"/token",serverTokenRevocationEndpoint:null,refreshAccessTokens:!0};t["default"]={serverTokenEndpoint:n.serverTokenEndpoint,serverTokenRevocationEndpoint:n.serverTokenRevocationEndpoint,refreshAccessTokens:n.refreshAccessTokens,load:r(n)}}),t("simple-auth-oauth2/ember",["./initializer"],function(e){"use strict";var t=e["default"];Ember.onLoad("Ember.Application",function(e){e.initializer(t)})}),t("simple-auth-oauth2/initializer",["./configuration","simple-auth/utils/get-global-config","simple-auth-oauth2/authenticators/oauth2","simple-auth-oauth2/authorizers/oauth2","exports"],function(e,t,r,n,i){"use strict";var s=e["default"],o=t["default"],a=r["default"],u=n["default"];i["default"]={name:"simple-auth-oauth2",before:"simple-auth",initialize:function(e){var t=o("simple-auth-oauth2");s.load(e,t),e.register("simple-auth-authorizer:oauth2-bearer",u),e.register("simple-auth-authenticator:oauth2-password-grant",a)}}}),t("simple-auth/authenticators/base",["exports"],function(t){t["default"]=e.SimpleAuth.Authenticators.Base}),t("simple-auth/authorizers/base",["exports"],function(t){t["default"]=e.SimpleAuth.Authorizers.Base}),t("simple-auth/utils/get-global-config",["exports"],function(t){t["default"]=e.SimpleAuth.Utils.getGlobalConfig}),t("simple-auth/utils/load-config",["exports"],function(t){t["default"]=e.SimpleAuth.Utils.loadConfig});var n=(r("simple-auth-oauth2/initializer")["default"],r("simple-auth-oauth2/configuration")["default"]),i=r("simple-auth-oauth2/authenticators/oauth2")["default"],s=r("simple-auth-oauth2/authorizers/oauth2")["default"];e.SimpleAuth.Configuration.OAuth2=n,e.SimpleAuth.Authenticators.OAuth2=i,e.SimpleAuth.Authorizers.OAuth2=s,r("simple-auth-oauth2/ember")}("undefined"!=typeof global?global:window);