!function(t){var e=t.define,i=t.require,n=t.Ember;"undefined"==typeof n&&"undefined"!=typeof i&&(n=i("ember")),n.libraries.register("Ember Simple Auth","0.6.4"),e("simple-auth/authenticators/base",["exports"],function(t){"use strict";t["default"]=n.Object.extend(n.Evented,{restore:function(){return new n.RSVP.reject},authenticate:function(){return new n.RSVP.reject},invalidate:function(){return new n.RSVP.resolve}})}),e("simple-auth/authorizers/base",["exports"],function(t){"use strict";t["default"]=n.Object.extend({session:null,authorize:function(){}})}),e("simple-auth/configuration",["./utils/get-global-config","exports"],function(t,e){"use strict";var i=t["default"];e["default"]={authenticationRoute:"login",routeAfterAuthentication:"index",sessionPropertyName:"session",authorizer:null,session:"simple-auth-session:main",store:"simple-auth-session-store:local-storage",crossOriginWhitelist:[],applicationRootUrl:null,load:function(t){var e=i("simple-auth");this.authenticationRoute=e.authenticationRoute||this.authenticationRoute,this.routeAfterAuthentication=e.routeAfterAuthentication||this.routeAfterAuthentication,this.sessionPropertyName=e.sessionPropertyName||this.sessionPropertyName,this.authorizer=e.authorizer||this.authorizer,this.session=e.session||this.session,this.store=e.store||this.store,this.crossOriginWhitelist=e.crossOriginWhitelist||this.crossOriginWhitelist,this.applicationRootUrl=t.lookup("router:main").get("rootURL")||"/"}}}),e("simple-auth/ember",["./initializer"],function(t){"use strict";var e=t["default"];n.onLoad("Ember.Application",function(t){t.initializer(e)})}),e("simple-auth/initializer",["./setup","exports"],function(t,e){"use strict";var i=t["default"];e["default"]={name:"simple-auth",initialize:function(t,e){i(t,e)}}}),e("simple-auth/mixins/application-route-mixin",["./../configuration","exports"],function(t,e){"use strict";var i=t["default"];e["default"]=n.Mixin.create({beforeModel:function(t){if(this._super(t),!this.get("_authEventListenersAssigned")){this.set("_authEventListenersAssigned",!0);var e=this;n.A(["sessionAuthenticationSucceeded","sessionAuthenticationFailed","sessionInvalidationSucceeded","sessionInvalidationFailed","authorizationFailed"]).forEach(function(n){e.get(i.sessionPropertyName).on(n,function(){Array.prototype.unshift.call(arguments,n),t.send.apply(t,arguments)})})}},actions:{authenticateSession:function(){this.transitionTo(i.authenticationRoute)},sessionAuthenticationSucceeded:function(){var t=this.get(i.sessionPropertyName).get("attemptedTransition");t?(t.retry(),this.get(i.sessionPropertyName).set("attemptedTransition",null)):this.transitionTo(i.routeAfterAuthentication)},sessionAuthenticationFailed:function(){},invalidateSession:function(){this.get(i.sessionPropertyName).invalidate()},sessionInvalidationSucceeded:function(){window.location.replace(i.applicationRootUrl)},sessionInvalidationFailed:function(){},authorizationFailed:function(){this.get(i.sessionPropertyName).get("isAuthenticated")&&this.get(i.sessionPropertyName).invalidate()}}})}),e("simple-auth/mixins/authenticated-route-mixin",["./../configuration","exports"],function(t,e){"use strict";var i=t["default"];e["default"]=n.Mixin.create({beforeModel:function(t){this._super(t),this.get(i.sessionPropertyName).get("isAuthenticated")||(t.abort(),this.get(i.sessionPropertyName).set("attemptedTransition",t),t.send("authenticateSession"))}})}),e("simple-auth/mixins/authentication-controller-mixin",["./../configuration","exports"],function(t,e){"use strict";var i=t["default"];e["default"]=n.Mixin.create({authenticator:null,actions:{authenticate:function(t){var e=this.get("authenticator");return n.assert("AuthenticationControllerMixin/LoginControllerMixin require the authenticator property to be set on the controller",!n.isEmpty(e)),this.get(i.sessionPropertyName).authenticate(this.get("authenticator"),t)}}})}),e("simple-auth/mixins/login-controller-mixin",["./../configuration","./authentication-controller-mixin","exports"],function(t,e,i){"use strict";var s=(t["default"],e["default"]);i["default"]=n.Mixin.create(s,{actions:{authenticate:function(){var t=this.getProperties("identification","password");return this.set("password",null),this._super(t)}}})}),e("simple-auth/session",["exports"],function(t){"use strict";t["default"]=n.ObjectProxy.extend(n.Evented,{authenticator:null,store:null,container:null,isAuthenticated:!1,attemptedTransition:null,content:{},authenticate:function(t,e){n.assert("Session#authenticate requires the authenticator factory to be specified, was "+t,!n.isEmpty(t));var i=this;return new n.RSVP.Promise(function(n,s){i.container.lookup(t).authenticate(e).then(function(e){i.setup(t,e,!0),n()},function(t){i.clear(),i.trigger("sessionAuthenticationFailed",t),s(t)})})},invalidate:function(){n.assert("Session#invalidate requires the session to be authenticated",this.get("isAuthenticated"));var t=this;return new n.RSVP.Promise(function(e,i){var n=t.container.lookup(t.authenticator);n.invalidate(t.content).then(function(){n.off("sessionDataUpdated"),t.clear(!0),e()},function(e){t.trigger("sessionInvalidationFailed",e),i(e)})})},restore:function(){var t=this;return new n.RSVP.Promise(function(e,i){var n=t.store.restore(),s=n.authenticator;s?(delete n.authenticator,t.container.lookup(s).restore(n).then(function(i){t.setup(s,i),e()},function(){t.store.clear(),i()})):(t.store.clear(),i())})},setup:function(t,e,i){e=n.merge(n.merge({},this.content),e),i=!!i&&!this.get("isAuthenticated"),this.beginPropertyChanges(),this.setProperties({isAuthenticated:!0,authenticator:t,content:e}),this.bindToAuthenticatorEvents(),this.updateStore(),this.endPropertyChanges(),i&&this.trigger("sessionAuthenticationSucceeded")},clear:function(t){t=!!t&&this.get("isAuthenticated"),this.beginPropertyChanges(),this.setProperties({isAuthenticated:!1,authenticator:null,content:{}}),this.store.clear(),this.endPropertyChanges(),t&&this.trigger("sessionInvalidationSucceeded")},setUnknownProperty:function(t,e){var i=this._super(t,e);return this.updateStore(),i},updateStore:function(){var t=this.content;n.isEmpty(this.authenticator)||(t=n.merge({authenticator:this.authenticator},t)),n.isEmpty(t)||this.store.persist(t)},bindToAuthenticatorEvents:function(){var t=this,e=this.container.lookup(this.authenticator);e.off("sessionDataUpdated"),e.off("sessionDataInvalidated"),e.on("sessionDataUpdated",function(e){t.setup(t.authenticator,e)}),e.on("sessionDataInvalidated",function(){t.clear(!0)})},bindToStoreEvents:function(){var t=this;this.store.on("sessionDataUpdated",function(e){var i=e.authenticator;i?(delete e.authenticator,t.container.lookup(i).restore(e).then(function(e){t.setup(i,e,!0)},function(){t.clear(!0)})):t.clear(!0)})}.observes("store")})}),e("simple-auth/setup",["./configuration","./session","./stores/local-storage","./stores/ephemeral","exports"],function(t,e,i,s,o){"use strict";function r(t){if("string"===n.typeOf(t)){var e=document.createElement("a");e.href=t,e.href=e.href,t=e}var i=t.port;return n.isEmpty(i)&&(i="http:"===t.protocol?"80":"https:"===t.protocol?"443":""),t.protocol+"//"+t.hostname+(""!==i?":"+i:"")}function a(t){if(t.crossDomain===!1)return!0;var e=p[t.url]=p[t.url]||r(t.url);return c.indexOf(e)>-1}function u(t){t.register("simple-auth-session-store:local-storage",f),t.register("simple-auth-session-store:ephemeral",d),t.register("simple-auth-session:main",h)}var c,l=t["default"],h=e["default"],f=i["default"],d=s["default"],p={};o["default"]=function(t,e){l.load(t),e.deferReadiness(),u(t);var i=t.lookup(l.store),s=t.lookup(l.session);if(s.setProperties({store:i,container:t}),n.A(["controller","route"]).forEach(function(e){t.injection(e,l.sessionPropertyName,l.session)}),c=n.A(l.crossOriginWhitelist).map(function(t){return r(t)}),n.isEmpty(l.authorizer))n.Logger.debug("No authorizer factory was configured for Ember Simple Auth - specify one if backend requests need to be authorized.");else{var o=t.lookup(l.authorizer);o&&(o.set("session",s),n.$.ajaxPrefilter(function(t,e,i){!o.isDestroyed&&a(t)&&o.authorize(i,t)}),n.$(document).ajaxError(function(t,e){401===e.status&&s.trigger("authorizationFailed")}))}var h=function(){e.advanceReadiness()};s.restore().then(h,h)}}),e("simple-auth/stores/base",["../utils/flat-objects-are-equal","exports"],function(t,e){"use strict";t["default"];e["default"]=n.Object.extend(n.Evented,{persist:function(){},restore:function(){return{}},clear:function(){}})}),e("simple-auth/stores/ephemeral",["./base","exports"],function(t,e){"use strict";var i=t["default"];e["default"]=i.extend({init:function(){this.clear()},persist:function(t){this._data=JSON.stringify(t||{})},restore:function(){return JSON.parse(this._data)||{}},clear:function(){delete this._data,this._data="{}"}})}),e("simple-auth/stores/local-storage",["./base","../utils/flat-objects-are-equal","exports"],function(t,e,i){"use strict";var s=t["default"],o=e["default"];i["default"]=s.extend({key:"ember_simple_auth:session",init:function(){this.bindToStorageEvents()},persist:function(t){t=JSON.stringify(t||{}),localStorage.setItem(this.key,t),this._lastData=this.restore()},restore:function(){var t=localStorage.getItem(this.key);return JSON.parse(t)||{}},clear:function(){localStorage.removeItem(this.key),this._lastData=null},bindToStorageEvents:function(){var t=this;n.$(window).bind("storage",function(){var e=t.restore();o(e,t._lastData)||(t._lastData=e,t.trigger("sessionDataUpdated",e))})}})}),e("simple-auth/utils/flat-objects-are-equal",["exports"],function(t){"use strict";t["default"]=function(t,e){function i(t){var e=[];for(var i in t)e.push([i,t[i]]);return e.sort(function(t,e){return t[0]<e[0]?-1:t[0]>e[0]?1:0})}return JSON.stringify(i(t))===JSON.stringify(i(e))}}),e("simple-auth/utils/get-global-config",["exports"],function(t){"use strict";var e="undefined"!=typeof window?window:{};t["default"]=function(t){return(e.ENV||{})[t]||{}}}),e("simple-auth/utils/is-secure-url",["exports"],function(t){"use strict";t["default"]=function(t){var e=document.createElement("a");return e.href=t,e.href=e.href,"https:"==e.protocol}})}("undefined"!=typeof global?global:window);