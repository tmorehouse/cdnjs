!function(e){"use strict";var t=!1,r=function(){},n=[],o=function(e,t){var r={};return Object.keys(e).forEach(function(t){r[t]=e[t]}),t&&Object.keys(t).forEach(function(e){r[e]=t[e]}),r},i=function(e,t,r,n,o){for(var d=0;d<t.length;d++){var s=t[d];Array.isArray(s)?n=i(s,r,n):(a(e,s,o),r.splice(n,0,s),n++)}return n},a=function(e,r,n){if(!t){var o=r.vnodeSelector;if(!(""===o||r.properties&&r.properties.key)){for(var i=0;i<n.length;i++)if(o===n[i])throw new Error("["+e+"] contains undistinguishable child nodes ["+o+"], please add unique key properties.");n.push(o)}}},d=function(e){return{vnodeSelector:"",text:null==e?"":""+e,domNode:null}},s=function(e,t){if(null===t||void 0===t)return null;if(!Array.isArray(t))return t.hasOwnProperty("vnodeSelector")?[t]:[d(t)];for(var r=0,n=[];r<t.length;){var o=t[r];null===o||void 0===o?t.splice(r,1):Array.isArray(o)?(t.splice(r,1),r=i(e,o,t,r,n)):o.hasOwnProperty("vnodeSelector")?(a(e,o,n),r++):(t[r]=d(o),r++)}return t},u=/([\.#]?[a-zA-Z0-9_:-]+)/,l={nodeToRemove:function(e){e.parentNode.removeChild(e)},nodeAdded:function(){},nodeUpdated:function(){}},c={namespace:null,transitions:l},p=function(e){return o(c,e)},f=function(e,t,r){if(t){var n=r.eventHandlerInterceptor;for(var o in t){var i=t[o];if("class"===o||"className"===o||"classList"===o)throw new Error("Not supported, use 'classes' instead.");if("classes"===o)for(var a in i)i[a]&&e.classList.add(a);else{if("key"===o)continue;var d=typeof i;"function"===d?(n&&(i=n(o,i,e)),e[o]=i):"string"===d?e.setAttribute(o,i):e[o]=i}}}},v=function(e,t,r,n){if(r){var o=n.transitions;for(var i in r){var a=r[i],d=t[i];if("classes"===i){if(a===d)continue;var s=e.classList;for(var u in a){var l=!!a[u],c=!!d[u];l!==c&&(l?(s.add(u),o.nodeUpdated(e,"addClass",u,void 0,void 0)):(s.remove(u),o.nodeUpdated(e,"removeClass",u,void 0,void 0)))}}else{if(a||"string"!=typeof d||(a=""),"value"===i){if(e.value===a){a!==d&&o.nodeUpdated(e,"property","value",a,d);continue}e.value=a,a!==d&&o.nodeUpdated(e,"property","value",a,d);continue}if(a!==d){var p=typeof a;if("function"===p)throw new Error("Functions may not be updated on subsequent renders (property: "+i+")");"string"===p?e.setAttribute(i,a):e[i]=a,o.nodeUpdated(e,"property",i,a,d)}}}}},m=function(e,t,r){t&&t.forEach(function(t){g(t,function(t){e.appendChild(t)},r)})},h=function(e,t){return e.vnodeSelector!==t.vnodeSelector?!1:e.properties&&t.properties?e.properties.key===t.properties.key:!e.properties&&!t.properties},y=function(e,t,r){if(""!==t.vnodeSelector)for(var n=r;n<e.length;n++)if(h(e[n],t))return n;return-1},w=function(e,t,r,o){if(t!==r){t=t||n,r=r||n;for(var i,a=o.transitions,d=0,s=0;s<r.length;){var u=d<t.length?t[d]:null,l=r[s];if(u&&h(u,l))A(u,l,o),d++;else{var c=y(t,l,d+1);if(c>=0){for(i=d;c>i;i++)a.nodeToRemove(t[i].domNode,t[i].properties);A(t[c],l,o),d=c+1}else g(l,function(r){if(d<t.length){var n=t[d];e.insertBefore(r,n.domNode)}else e.appendChild(r)},o),a.nodeAdded(l.domNode,l.properties)}s++}if(t.length>d)for(i=d;i<t.length;i++)a.nodeToRemove(t[i].domNode,t[i].properties)}},g=function(e,t,r){if(""===e.vnodeSelector)e.domNode=document.createTextNode(e.text),t(e.domNode);else{var n,i,a,d,s=e.vnodeSelector.split(u);for(a=0;a<s.length;a++)i=s[a],i&&(d=i.charAt(0),n?"."===d?n.classList.add(i.substring(1)):"#"===d&&(n.id=i.substr(1)):("svg"===i&&(r=o(r,{namespace:"http://www.w3.org/2000/svg"})),n=e.domNode=r.namespace?document.createElementNS(r.namespace,i):document.createElement(i),t(n)));N(n,e,r)}},N=function(e,t,r){f(e,t.properties,r),m(e,t.children,r),t.properties&&t.properties.afterCreate&&t.properties.afterCreate(e,r,t.vnodeSelector,t.properties,t.children)},A=function(e,t,r){var n=e.domNode;if(!n)throw new Error("previous node was not mounted");e!==t&&(""===t.vnodeSelector?t.text!==e.text&&(n.nodeValue=t.text,r.transitions.nodeUpdated(n,"text",void 0,t.text,e.text)):(v(n,e.properties,t.properties,r),w(n,e.children,t.children,r),t.properties&&t.properties.afterUpdate&&t.properties.afterUpdate(n,r,t.vnodeSelector,t.properties,t.children)),t.domNode=e.domNode)},S=e.performance||{offset:new Date,now:function(){return new Date-this.offset}},x={lastCreateVDom:null,lastCreateDom:null,lastUpdateVDom:null,lastUpdateDom:null,lastProjector:null,createExecuted:function(e,t,r,n){x.lastProjector=n,x.lastCreateVDom=t-e,x.lastCreateDom=r-t},updateExecuted:function(e,t,r,n){x.lastProjector=n,x.lastUpdateVDom=t-e,x.lastUpdateDom=r-t}},D=function(e,t){return{update:function(r){if(e.vnodeSelector!==r.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using mergeDom with one extra level)");A(e,r,t),e=r},domNode:e.domNode}},C={h:function(e,t,r){return!r&&("string"==typeof t||Array.isArray(t)||t&&t.hasOwnProperty("vnodeSelector"))&&(r=t,t=null),r=s(e,r),{vnodeSelector:e,properties:t,children:r,domNode:null}},createDom:function(e,t){return t=p(t),g(e,r,t),D(e,t)},appendToDom:function(e,t,r){r=p(r);var n=append.appendChild?function(e){append.appendChild(e)}:append;return g(t,n,r),D(t,r)},mergeDom:function(e,t,r){return r=p(r),t.domNode=e,N(e,t,r),D(t,r)},createProjector:function(e,t,r){r=p(r),r.eventHandlerInterceptor=function(e,t){return function(){return d.scheduleRender(),t.apply(this,arguments)}};var n,o=null,i=!1,a=function(){if(n=null,o){var i=S.now(),a=t(),s=S.now();o.update(a),x.updateExecuted(i,s,S.now(),d)}else{var u=S.now(),l=t(),c=S.now();o=C.mergeDom(e,l,r),x.createExecuted(u,c,S.now(),d)}};n=requestAnimationFrame(a);var d={scheduleRender:function(){n||i||(n=requestAnimationFrame(a))},destroy:function(){n&&(cancelAnimationFrame(n),n=null),i=!0}};return d},createCache:function(){var e=null,t=null,r={invalidate:function(){t=null,e=null},result:function(r,n){if(e)for(var o=0;o<r.length;o++)e[o]!==r[o]&&(t=null);return t||(t=n(),e=r),t}};return r},stats:x};C.renderLoop=C.createProjector,"undefined"!=typeof module&&module.exports?module.exports=C:"function"==typeof define&&define.amd?define(function(){return C}):window.maquette=C}(this);