function Runnable(t,e){this.title=t,this.fn=e,this.async=e&&e.length,this.sync=!this.async,this._timeout=2e3,this.timedOut=!1}var EventEmitter=require("events").EventEmitter,debug=require("debug")("runnable");module.exports=Runnable,Runnable.prototype.__proto__=EventEmitter.prototype,Runnable.prototype.timeout=function(t){return 0==arguments.length?this._timeout:(debug("timeout %d",t),this._timeout=t,this.timer&&this.resetTimeout(),this)},Runnable.prototype.fullTitle=function(){return this.parent.fullTitle()+" "+this.title},Runnable.prototype.clearTimeout=function(){clearTimeout(this.timer)},Runnable.prototype.resetTimeout=function(){var t=this,e=this.timeout();this.clearTimeout(),e&&(this.timer=setTimeout(function(){t.callback(new Error("timeout of "+e+"ms exceeded")),t.timedOut=!0},e))},Runnable.prototype.run=function(t){function e(){r||(r=!0,o.emit("error",new Error("done() called multiple times")))}function i(i){if(!o.timedOut){if(n)return e();o.clearTimeout(),o.duration=new Date-s,n=!0,t(i)}}var n,r,o=this,u=this.timeout(),s=new Date,l=this.ctx;if(l&&l.runnable(this),this.async&&u&&(this.timer=setTimeout(function(){i(new Error("timeout of "+u+"ms exceeded")),o.timedOut=!0},u)),this.callback=i,this.async)try{this.fn.call(l,function(t){return t instanceof Error?i(t):null!=t?i(new Error("done() invoked with non-Error: "+t)):void i()})}catch(a){i(a)}else try{this.pending||this.fn.call(l),this.duration=new Date-s,t()}catch(a){t(a)}};