function isArray(t){return"[object Array]"=={}.toString.call(t)}function EventEmitter(){}exports.EventEmitter=EventEmitter,EventEmitter.prototype.on=function(t,e){return this.$events||(this.$events={}),this.$events[t]?isArray(this.$events[t])?this.$events[t].push(e):this.$events[t]=[this.$events[t],e]:this.$events[t]=e,this},EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prototype.once=function(t,e){function s(){n.removeListener(t,s),e.apply(this,arguments)}var n=this;return s.listener=e,this.on(t,s),this},EventEmitter.prototype.removeListener=function(t,e){if(this.$events&&this.$events[t]){var s=this.$events[t];if(isArray(s)){for(var n=-1,i=0,r=s.length;r>i;i++)if(s[i]===e||s[i].listener&&s[i].listener===e){n=i;break}if(0>n)return this;s.splice(n,1),s.length||delete this.$events[t]}else(s===e||s.listener&&s.listener===e)&&delete this.$events[t]}return this},EventEmitter.prototype.removeAllListeners=function(t){return void 0===t?(this.$events={},this):(this.$events&&this.$events[t]&&(this.$events[t]=null),this)},EventEmitter.prototype.listeners=function(t){return this.$events||(this.$events={}),this.$events[t]||(this.$events[t]=[]),isArray(this.$events[t])||(this.$events[t]=[this.$events[t]]),this.$events[t]},EventEmitter.prototype.emit=function(t){if(!this.$events)return!1;var e=this.$events[t];if(!e)return!1;var s=[].slice.call(arguments,1);if("function"==typeof e)e.apply(this,s);else{if(!isArray(e))return!1;for(var n=e.slice(),i=0,r=n.length;r>i;i++)n[i].apply(this,s)}return!0};