function Suite(t,e){this.title=t,this.ctx=e,this.suites=[],this.tests=[],this._beforeEach=[],this._beforeAll=[],this._afterEach=[],this._afterAll=[],this.root=!t,this._timeout=2e3,this._bail=!1}var EventEmitter=require("events").EventEmitter,debug=require("debug")("suite"),utils=require("./utils"),Hook=require("./hook");exports=module.exports=Suite,exports.create=function(t,e){var i=new Suite(e,t.ctx);return i.parent=t,e=i.fullTitle(),t.addSuite(i),i},Suite.prototype.__proto__=EventEmitter.prototype,Suite.prototype.clone=function(){var t=new Suite(this.title);return debug("clone"),t.ctx=this.ctx,t.timeout(this.timeout()),t.bail(this.bail()),t},Suite.prototype.timeout=function(t){return 0==arguments.length?this._timeout:(String(t).match(/s$/)&&(t=1e3*parseFloat(t)),debug("timeout %d",t),this._timeout=parseInt(t,10),this)},Suite.prototype.bail=function(t){return 0==arguments.length?this._bail:(debug("bail %s",t),this._bail=t,this)},Suite.prototype.beforeAll=function(t){var e=new Hook('"before all" hook',t);return e.parent=this,e.timeout(this.timeout()),e.ctx=this.ctx,this._beforeAll.push(e),this.emit("beforeAll",e),this},Suite.prototype.afterAll=function(t){var e=new Hook('"after all" hook',t);return e.parent=this,e.timeout(this.timeout()),e.ctx=this.ctx,this._afterAll.push(e),this.emit("afterAll",e),this},Suite.prototype.beforeEach=function(t){var e=new Hook('"before each" hook',t);return e.parent=this,e.timeout(this.timeout()),e.ctx=this.ctx,this._beforeEach.push(e),this.emit("beforeEach",e),this},Suite.prototype.afterEach=function(t){var e=new Hook('"after each" hook',t);return e.parent=this,e.timeout(this.timeout()),e.ctx=this.ctx,this._afterEach.push(e),this.emit("afterEach",e),this},Suite.prototype.addSuite=function(t){return t.parent=this,t.timeout(this.timeout()),t.bail(this.bail()),this.suites.push(t),this.emit("suite",t),this},Suite.prototype.addTest=function(t){return t.parent=this,t.timeout(this.timeout()),t.ctx=this.ctx,this.tests.push(t),this.emit("test",t),this},Suite.prototype.fullTitle=function(){if(this.parent){var t=this.parent.fullTitle();if(t)return t+" "+this.title}return this.title},Suite.prototype.total=function(){return utils.reduce(this.suites,function(t,e){return t+e.total()},0)+this.tests.length},Suite.prototype.eachTest=function(t){return utils.forEach(this.tests,t),utils.forEach(this.suites,function(e){e.eachTest(t)}),this};