!function(n){function s(n){function s(n,s){for(var t=null,i=0;i<s.length&&n!=s[i];++i)s[i].stack==n.stack&&(t=s[i]);return t}function t(n,t,i){if(null!=t.stack){var l=s(t,n.getData());if(l){for(var o,e,f,u,r,a,p,h=i.pointsize,c=i.points,g=l.datapoints.pointsize,k=l.datapoints.points,v=[],z=t.lines.show,b=t.bars.horizontal,d=h>2&&(b?i.format[2].x:i.format[2].y),y=z&&t.lines.steps,D=!0,j=b?1:0,w=b?0:1,x=0,Q=0;;){if(x>=c.length)break;if(p=v.length,null==c[x]){for(m=0;h>m;++m)v.push(c[x+m]);x+=h}else if(Q>=k.length){if(!z)for(m=0;h>m;++m)v.push(c[x+m]);x+=h}else if(null==k[Q]){for(m=0;h>m;++m)v.push(null);D=!0,Q+=g}else{if(o=c[x+j],e=c[x+w],u=k[Q+j],r=k[Q+w],a=0,o==u){for(m=0;h>m;++m)v.push(c[x+m]);v[p+w]+=r,a=r,x+=h,Q+=g}else if(o>u){if(z&&x>0&&null!=c[x-h]){for(f=e+(c[x-h+w]-e)*(u-o)/(c[x-h+j]-o),v.push(u),v.push(f+r),m=2;h>m;++m)v.push(c[x+m]);a=r}Q+=g}else{if(D&&z){x+=h;continue}for(m=0;h>m;++m)v.push(c[x+m]);z&&Q>0&&null!=k[Q-g]&&(a=r+(k[Q-g+w]-r)*(o-u)/(k[Q-g+j]-u)),v[p+w]+=a,x+=h}D=!1,p!=v.length&&d&&(v[p+2]+=a)}if(y&&p!=v.length&&p>0&&null!=v[p]&&v[p]!=v[p-h]&&v[p+1]!=v[p-h+1]){for(m=0;h>m;++m)v[p+h+m]=v[p+m];v[p+1]=v[p-h+1]}}i.points=v}}}n.hooks.processDatapoints.push(t)}var t={series:{stack:null}};n.plot.plugins.push({init:s,options:t,name:"stack",version:"1.2"})}(jQuery);