angular.module("ng-context-menu",[]).factory("ContextMenuService",function(){return{menuElement:null}}).directive("contextMenu",["$window","$parse","ContextMenuService",function(e,n,t){return{restrict:"A",link:function(u,o,a){function l(e,n){n.addClass("open"),n.css("top",Math.max(e.pageY,0)+"px"),n.css("left",Math.max(e.pageX,0)+"px"),r=!0}function c(e){r=!1,e.removeClass("open")}function i(e){p||!r||2===e.button&&e.target===m||u.$apply(function(){c(t.menuElement)})}var m,r=!1,p=u.$eval(a.contextMenuDisabled),f=angular.element(e),d=n(a.contextMenu);o.bind("contextmenu",function(e){p||(null!==t.menuElement&&c(t.menuElement),t.menuElement=angular.element(document.getElementById(a.target)),m=e.target,e.preventDefault(),e.stopPropagation(),u.$apply(function(){d(u,{$event:e}),l(e,t.menuElement)}))}),f.bind("keyup",function(e){!p&&r&&27===e.keyCode&&u.$apply(function(){c(t.menuElement)})}),f.bind("click",i),f.bind("contextmenu",i)}}}]);