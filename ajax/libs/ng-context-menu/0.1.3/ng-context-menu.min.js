angular.module("ng-context-menu",[]).factory("ContextMenuService",function(){return{menuElement:null}}).directive("contextMenu",["$document","ContextMenuService",function(e,n){return{restrict:"A",scope:{callback:"&contextMenu",disabled:"&contextMenuDisabled"},link:function(t,u,l){function a(e,n){n.addClass("open"),n.css("top",Math.max(e.pageY,0)+"px"),n.css("left",Math.max(e.pageX,0)+"px"),m=!0}function c(e){e.removeClass("open"),m=!1}function o(e){t.disabled()||!m||2===e.button&&e.target===i||t.$apply(function(){c(n.menuElement)})}var i,m=!1;u.bind("contextmenu",function(e){t.disabled()||(null!==n.menuElement&&c(n.menuElement),n.menuElement=angular.element(document.getElementById(l.target)),i=e.target,e.preventDefault(),e.stopPropagation(),t.$apply(function(){t.callback({$event:e}),a(e,n.menuElement)}))}),e.bind("keyup",function(e){!t.disabled()&&m&&27===e.keyCode&&t.$apply(function(){c(n.menuElement)})}),e.bind("click",o),e.bind("contextmenu",o)}}}]);