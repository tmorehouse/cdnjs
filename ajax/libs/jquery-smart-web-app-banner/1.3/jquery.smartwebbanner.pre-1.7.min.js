/*!
 * jQuery Smart Web App Banner (Add to Home Screen)
 * Copyright (c) 2012 Kurt Zenisek @ kzeni.com
 * Version: 1.3-legacy (22-MAR-2013)
 * Requires: jQuery v1.3.2 until v1.7 (newer version is available for jQuery 1.7+)
 */
;(function($){$.fn.smartWebBanner=function(e){var f=parseFloat($('html').css('margin-top'));var g=navigator.userAgent.match(/iPad/i)!=null;var h=navigator.userAgent.match(/iPhone/i)!=null;var j=(/Safari/i).test(navigator.appVersion)&&!(/CriOS/i).test(navigator.appVersion);var k=navigator.standalone;var l;var m=document.title;var n=window.location.href;if(typeof e=='String'){if(typeof o=='undefined')var o=$.fn.smartWebBanner.defaults;switch(e){case'show':if(!$('#smartWebBanner').hasClass('shown')){showBanner()}return false;case'hide':if($('#smartWebBanner').hasClass('shown')){f=f-l;closeBanner()}return false}}else{var o=$.extend({},$.fn.smartWebBanner.defaults,e)}if(o.autoApp&&$('meta[name="apple-mobile-web-app-capable"]').length==0)$('head').append('<meta name="apple-mobile-web-app-capable" content="yes" />');function createBanner(){$('body').append('<div id="smartWebBanner"><a href="#" id="swb-close">X</a><a href="#" id="swb-icon"></a><div id="swb-info"><strong>'+o.title+'</strong><span>'+o.author+'</span></div><a href="#" id="swb-save">Save</a></div><div id="swb-instructions">Tap <span class="icon"></span> and then <strong>Add to Home Screen.</strong><div class="arrow"></div></div>');if(g)$('#smartWebBanner,#swb-instructions').addClass('ipad');if(!g&&!h)$('#swb-instructions').html('<strong>It appears this isn\'t an iOS device.</strong> This is a preview of the iPhone popup design though.');if(o.showFree)$('#smartWebBanner').addClass('free');if(o.theme=='dark')$('#smartWebBanner').addClass('dark');if(o.useIcon){if($('link[rel="apple-touch-icon-precomposed"]').length>0){iconURL=$('link[rel="apple-touch-icon-precomposed"]').attr('href')}else if($('link[rel="apple-touch-icon"]').length>0){iconURL=$('link[rel="apple-touch-icon"]').attr('href');if(o.iconGloss!=false)$('#swb-icon').addClass('gloss')}if(o.iconGloss==true)$('#swb-icon').addClass('gloss');if(o.iconOverwrite!='')iconURL=o.iconOverwrite;$('#swb-icon').css('background-image','url('+iconURL+')')}if(!o.useIcon||!iconURL){$('#smartWebBanner').addClass('no-icon')}l=$('#smartWebBanner').height()}function showBanner(){$('#smartWebBanner').stop().animate({top:0},o.speedIn).addClass('shown');$('html').animate({marginTop:f+l},o.speedIn);$('#swb-close').live('click',function(){closeBanner();return false});$('#swb-save,#swb-icon').live('click',function(){showInstructions();return false})}function closeBanner(){$('#smartWebBanner').stop().animate({top:-(l+(l/3))},o.speedOut).removeClass('shown');$('html').animate({marginTop:f},o.speedOut);hideInstructions();setCookie('swb-closed','true',o.daysHidden)}function showInstructions(){$('#swb-instructions').fadeIn(o.popupSpeedIn);if(o.titleSwap)document.title=o.title;if(o.url)history.replaceState(null,null,o.url);if(o.popupDuration!=0)setTimeout(function(){hideInstructions()},o.popupDuration);setCookie('swb-saved','true',o.daysReminder)}function hideInstructions(){$('#swb-instructions').fadeOut(o.popupSpeedOut);if(o.titleSwap)setTimeout(function(){document.title=m},12000);if(o.url)setTimeout(function(){history.replaceState(null,null,n)},12000)}function setCookie(a,b,c){var d=new Date();d.setDate(d.getDate()+c);var b=escape(b)+((c==null)?'':'; expires='+d.toUTCString());document.cookie=a+'='+b+'; path=/;'}function getCookie(a){var i,x,y,ARRcookies=document.cookie.split(";");for(i=0;i<ARRcookies.length;i++){x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);x=x.replace(/^\s+|\s+$/g,"");if(x==a){return unescape(y)}}}if(o.debug||((h||g)&&j&&!k&&typeof getCookie('swb-closed')=='undefined'&&typeof getCookie('swb-saved')=='undefined')){createBanner();showBanner()}};$.fn.smartWebBanner.defaults={title:'Web App',titleSwap:true,url:'',author:'Save to Home Screen',speedIn:300,speedOut:400,useIcon:true,iconOverwrite:'',iconGloss:'auto',showFree:true,daysHidden:15,daysReminder:90,popupDuration:6000,popupSpeedIn:200,popupSpeedOut:900,theme:'light',autoApp:false,debug:false}})(jQuery);
