/*
 * Media Element
 * HTML5 <video> libary
 * http://mediaelementjs.com/
 *
 * Creates a JavaScript object that mimics HTML5 media objects
 * through a Flash->JavaScript|Silverlight bridge
 *
 * Copyright 2010, John Dyer
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Version: 1.0.X
 */
(function(){var a=a||{};a.meIndex=0;a.plugins={silverlight:[{version:[3,0],type:"video/mp4"},{version:[3,0],type:"video/m4v"},{version:[3,0],type:"video/mov"},{version:[3,0],type:"video/wmv"},{version:[3,0],type:"audio/wma"},{version:[3,0],type:"audio/mp4"},{version:[3,0],type:"audio/m4a"},{version:[3,0],type:"audio/mp3"}],flash:[{version:[9,0,124],type:"video/mp4"},{version:[9,0,124],type:"video/flv"},{version:[9,0,124],type:"video/mov"},{version:[9,0,124],type:"audio/mp3"},{version:[9,0,124],type:"audio/m4a"},{version:[9,0,124],type:"audio/mp4"},{version:[9,0,124],type:"audio/flv"}]};var c={hasPluginVersion:function(f,d){var e=this.plugins[f];d[1]=d[1]||0;d[2]=d[2]||0;return(e[0]>d[0]||(e[0]==d[0]&&e[1]>d[1])||(e[0]==d[0]&&e[1]==d[1]&&e[2]>=d[2]))?true:false},nav:window.navigator,ua:window.navigator.userAgent.toLowerCase(),plugins:[],addPlugin:function(g,f,h,d,e){this.plugins[g]=this.detectPlugin(f,h,d,e)},detectPlugin:function(l,g,h,o){var m=[0,0,0],n,j,f;if(typeof(this.nav.plugins)!="undefined"&&typeof this.nav.plugins[l]=="object"){n=this.nav.plugins[l].description;if(n&&!(typeof this.nav.mimeTypes!="undefined"&&this.nav.mimeTypes[g]&&!this.nav.mimeTypes[g].enabledPlugin)){m=n.replace(l,"").replace(/^\s+/,"").replace(/\sr/gi,".").split(".");for(j=0;j<m.length;j++){m[j]=parseInt(m[j],10)}}}else{if(typeof(window.ActiveXObject)!="undefined"){try{f=new ActiveXObject(h);if(f){m=o(f)}}catch(k){}}}return m}};c.addPlugin("flash","Shockwave Flash","application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash",function(f){var e=[],g=f.GetVariable("$version");if(g){g=g.split(" ")[1].split(",");e=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)]}return e});c.addPlugin("silverlight","Silverlight Plug-In","application/x-silverlight-2","AgControl.AgControl",function(e){var d=[0,0,0,0],f=function(j,g,h,k){while(j.isVersionSupported(g[0]+"."+g[1]+"."+g[2]+"."+g[3])){g[h]+=k}g[h]-=k};f(e,d,0,1);f(e,d,1,1);f(e,d,2,10000);f(e,d,2,1000);f(e,d,2,100);f(e,d,2,10);f(e,d,2,1);f(e,d,3,1);return d});if(c.ua.match(/Android 2\.[12]/)!=null){HTMLMediaElement.canPlayType=function(d){return(d.match(/video\/(mp4m4v)/)!=null)?"probably":""}}a.Utility={escapeHTML:function(d){return d.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")},absolutizeUrl:function(d){var e=document.createElement("div");e.innerHTML='<a href="'+this.escapeHTML(d)+'">x</a>';return e.firstChild.href},getScriptPath:function(e){var l="";var d=document.getElementsByTagName("script");for(var k=0;k<d.length;k++){var f=d[k].src;for(var h=0;h<e.length;h++){var g=e[h];if(f.indexOf(g)>-1){l=f.substring(0,f.indexOf(g));break}}if(l!=""){break}}return l}};var b={enablePluginDebug:false,plugins:["silverlight","flash"],type:"",flashName:"flashmediaelement.swf",silverlightName:"silverlightmediaelement.xap",defaultVideoWidth:480,defaultVideoHeight:270,pluginPath:a.Utility.getScriptPath(["mediaelement.js","mediaelement.min.js","mediaelement-and-player.js","mediaelement-and-player.min.js"]),pluginWidth:-1,pluginHeight:-1,success:function(){},error:function(){}};a.MediaElement=function(f,E){var l=(typeof(f)=="string")?document.getElementById(f):f,M=(l.tagName.toLowerCase()=="video"),w=(typeof(l.canPlayType)!="undefined"),K=false,L="",n="",r="",j=b;for(var h in E){j[h]=E[h]}function g(e,o){if(o&&!e){var Q=o.substring(o.lastIndexOf(".")+1);e=((M)?"video":"audio")+"/"+Q}if(w&&l.canPlayType(e).replace(/no/,"")!=""){K=true}else{for(pi=0;pi<j.plugins.length;pi++){var m=j.plugins[pi];var i=a.plugins[m];for(var P=0;P<i.length;P++){if(e==i[P].type&&c.hasPluginVersion(m,i[P].version)){L=o;n=m}}}}}if(typeof(j.type)!="undefined"&&j.type!=""){g(j.type,null)}else{if(l.getAttribute("src")!="undefined"&&l.getAttribute("src")!=null){var s=l.getAttribute("src");var k=l.getAttribute("type");g(k,s);r=s}else{for(var I=0;I<l.childNodes.length;I++){var f=l.childNodes[I];if(f.nodeType==1&&f.tagName.toLowerCase()=="source"){var k=f.getAttribute("type");var s=f.getAttribute("src");g(k,s);if(r==""){r=s}}}}}if(!w&&navigator.userAgent.indexOf("Safari")>-1){l.innerHTML="You need to install Quicktime for Safari to operate properly. Weird, huh?";j.error(l);return}if(K){for(var H in a.HtmlMediaElement){l[H]=a.HtmlMediaElement[H]}var q=false;var z=(l.getAttribute("autoplay")!=null);if(z){function p(){if(!q){l.play()}}var t="progress timeupdate".split(" ");function d(){for(var e in t){l.addEventListener(t[e],p,false)}}function A(){for(var e in t){l.removeEventListener(t[e],p,false)}}d();l.addEventListener("playing",function(){q=true;A()},true)}j.success(l,l);return l}else{if(n!=""){var F=1,D=1,O="me_"+n+"_"+(a.meIndex++),u=(L!=null)?a.Utility.absolutizeUrl(L):"",N=(l.getAttribute("poster")==null)?l.getAttribute("poster"):"",z=(l.getAttribute("autoplay")!=null);if(M){F=(j.videoWidth>0)?j.videoWidth:(l.getAttribute("width")!==null)?l.getAttribute("width"):j.defaultVideoWidth;D=(j.videoHeight>0)?j.videoHeight:(l.getAttribute("height")!==null)?l.getAttribute("height"):j.defaultVideoHeight}else{if(j.enablePluginDebug){F=320;D=240}}var G=new a.PluginMediaElement(O,n);G.success=j.success;a.MediaPluginBridge.registerPluginElement(O,G,l);var y=document.createElement("div");y.className="me-plugin";l.parentNode.insertBefore(y,l);var C=["id="+O,"poster="+N,"autoplay="+z,"width="+F,"height="+D];if(u!=null){C.push("file="+u)}if(j.enablePluginDebug){C.push("debug=true")}var v="";switch(n){case"silverlight":y.innerHTML='<object data="data:application/x-silverlight-2," type="application/x-silverlight-2"id="'+O+'" width="'+F+'" height="'+D+'"><param name="initParams" value="'+C.join(",")+'" /><param name="windowless" value="true" /><param name="background" value="black" /><param name="minRuntimeVersion" value="3.0.0.0" /><param name="autoUpgrade" value="true" /><param name="source" value="'+j.pluginPath+j.silverlightName+'" /></object>';break;case"flash":if(navigator.appName.indexOf("Microsoft")!=-1){y.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab"id="'+O+'" width="'+F+'" height="'+D+'"> <param name="movie" value="'+j.pluginPath+j.flashName+"?x="+(new Date())+'" /> <param name="flashvars" value="'+C.join("&")+'" /> <param name="quality" value="high" /> <param name="bgcolor" value="#000000" /> <param name="wmode" value="transparent" /> <param name="allowScriptAccess" value="sameDomain" /> <param name="allowFullScreen" value="true" /> </object>'}else{y.innerHTML='<embed name="'+O+'" play="true" loop="false" quality="high" bgcolor="#000000" wmode="transparent" allowScriptAccess="sameDomain" allowFullScreen="true" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+j.pluginPath+j.flashName+"?"+C.join("&")+'" width="'+F+'" height="'+D+'"></embed>'}break}l.style.display="none";return G}else{var B=document.createElement("div");B.className="me-cannotplay";try{B.style.width=l.width+"px";B.style.height=l.height+"px"}catch(J){}var x=l.getAttribute("poster");if(x=="undefined"||x==""||x==null){B.innerHTML='<a href="'+r+'">Download file</a>'}else{B.innerHTML='<a href="'+r+'"><img src="'+l.getAttribute("poster")+'" /></a>'}l.parentNode.insertBefore(B,l);l.style.display="none";j.error(l)}}};a.HtmlMediaElement={pluginType:"native",setCurrentTime:function(d){this.currentTime=d},setMuted:function(d){this.muted=d},setVolume:function(d){this.volume=d},setSrc:function(d){this.src=d},setVideoSize:function(e,d){this.width=e;this.height=d}};a.PluginMediaElement=function(d,f){var e={};return{id:d,pluginType:f,pluginElement:null,playbackRate:-1,defaultPlaybackRate:-1,seekable:[],played:[],paused:true,ended:false,seeking:false,duration:0,muted:false,volume:1,currentTime:0,play:function(){this.pluginApi.playMedia();this.paused=false},load:function(){this.pluginApi.loadMedia();this.paused=false},pause:function(){this.pluginApi.pauseMedia();this.paused=true},setSrc:function(g){this.pluginApi.setSrc(a.Utility.absolutizeUrl(g))},setCurrentTime:function(g){this.pluginApi.setCurrentTime(g);this.currentTime=g},setVolume:function(g){this.pluginApi.setVolume(g);this.volume=g},setMuted:function(g){this.pluginApi.setMuted(g);this.muted=g},setVideoSize:function(h,g){if(this.pluginElement.style){this.pluginElement.style.width=h+"px";this.pluginElement.style.height=g+"px"}this.pluginApi.setVideoSize(h,g)},setFullscreen:function(g){this.pluginApi.setFullscreen(g)},addEventListener:function(h,i,g){e[h]=e[h]||[];e[h].push(i)},dispatchEvent:function(g){var j,k=e[g],h;if(k){h=Array.prototype.slice.call(arguments,1);for(j=0;j<k.length;j++){k[j].apply(null,h)}}}}};a.MediaPluginBridge=(function(){var d=[],e=[];return{registerPluginElement:function(h,g,f){d[h]=g;e[h]=f},initPlugin:function(h){var g=d[h],f=e[h];switch(g.pluginType){case"flash":if(navigator.appName.indexOf("Microsoft")!=-1){g.pluginElement=g.pluginApi=window[h]}else{g.pluginElement=g.pluginApi=document[h]}break;case"silverlight":g.pluginElement=document.getElementById(g.id);g.pluginApi=g.pluginElement.Content.SilverlightApp;break}if(g.success){g.success(g,f)}},fireEvent:function(m,h,g){var k=d[m];k.ended=false;k.paused=false;var l={type:h,target:k};for(var j in g){k[j]=g[j];l[j]=g[j]}var f=g.bufferedTime||0;l.target.buffered=l.buffered={start:function(i){return 0},end:function(i){return f},length:1};k.dispatchEvent(l.type,l)}}}());window.html5=a;window.MediaElement=a.MediaElement})();