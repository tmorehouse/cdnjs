!function(){function t(t,s,n){n=n||[];for(var r in s)e(n,r)||(t[r]=s[r]);return t}function e(t,e){for(var s=0;s<t.length;s++)if(t[s]===e)return!0;return!1}function s(t){var e=new i,s=new n,a=t.XMLHttpRequest,u=r(e,s);this.install=function(){t.XMLHttpRequest=u},this.uninstall=function(){t.XMLHttpRequest=a,this.stubs.reset(),this.requests.reset()},this.stubRequest=function(t,e){var n=new o(t,e);return s.addStub(n),n},this.withMock=function(t){this.install();try{t()}finally{this.uninstall()}},this.requests=e,this.stubs=s}function n(){var t=[];this.addStub=function(e){t.push(e)},this.reset=function(){t=[]},this.findStub=function(e,s){for(var n=t.length-1;n>=0;n--){var r=t[n];if(r.matches(e,s))return r}}}function r(e,s){function n(){e.track(this),this.requestHeaders={}}var r=["responseBody","responseText","responseXML","status","statusText","responseTimeout"];return t(n.prototype,new window.XMLHttpRequest,r),t(n.prototype,{open:function(){this.method=arguments[0],this.url=arguments[1],this.username=arguments[3],this.password=arguments[4],this.readyState=1,this.onreadystatechange()},setRequestHeader:function(t,e){this.requestHeaders[t]=e},abort:function(){this.readyState=0,this.status=0,this.statusText="abort",this.onreadystatechange()},readyState:0,onload:function(){},onreadystatechange:function(){},status:null,send:function(t){this.params=t,this.readyState=2,this.onreadystatechange();var e=s.findStub(this.url,t);e&&this.response(e)},data:function(){var t={};if("string"!=typeof this.params)return t;for(var e=this.params.split("&"),s=0;s<e.length;++s){var n=e[s].replace(/\+/g," ").split("="),r=decodeURIComponent(n[0]);t[r]=t[r]||[],t[r].push(decodeURIComponent(n[1]))}return t},getResponseHeader:function(t){return this.responseHeaders[t]},getAllResponseHeaders:function(){var t=[];for(var e in this.responseHeaders)this.responseHeaders.hasOwnProperty(e)&&t.push(e+": "+this.responseHeaders[e]);return t.join("\r\n")},responseText:null,response:function(t){this.status=t.status,this.statusText=t.statusText||"",this.responseText=t.responseText||"",this.readyState=4,this.responseHeaders=t.responseHeaders||{"Content-type":t.contentType||"application/json"},this.onload(),this.onreadystatechange()},responseTimeout:function(){this.readyState=4,jasmine.clock().tick(3e4),this.onreadystatechange("timeout")}}),n}function i(){var t=[];this.track=function(e){t.push(e)},this.first=function(){return t[0]},this.count=function(){return t.length},this.reset=function(){t=[]},this.mostRecent=function(){return t[t.length-1]},this.at=function(e){return t[e]},this.filter=function(e){if(0==t.length)return[];for(var s=[],n=0;n<t.length;n++)e instanceof RegExp&&e.test(t[n].url)?s.push(t[n]):e instanceof Function&&e(t[n])?s.push(t[n]):t[n].url==e&&s.push(t[n]);return s}}function o(t,e){var s=t.split("?");this.url=s[0];var n=function(t){return t?t.split("&").sort().join("&"):void 0};this.query=n(s[1]),this.data=n(e),this.andReturn=function(t){this.status=t.status||200,this.contentType=t.contentType,this.responseText=t.responseText},this.matches=function(t,e){var s=t.split("?"),r=s[0],i=s[1];return this.url===r&&this.query===n(i)&&(!this.data||this.data===n(e))}}"undefined"==typeof window&&"object"==typeof exports?(exports.MockAjax=s,jasmine.Ajax=new s(exports)):(window.MockAjax=s,jasmine.Ajax=new s(window))}();