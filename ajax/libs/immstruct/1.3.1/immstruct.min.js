/**
* immstruct v1.3.1
* Authors: Mikael Brevik, @torgeir
***************************************/
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.immstruct=t()}}(function(){return function t(e,n,r){function i(s,u){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[s]={exports:{}};e[s][0].call(f.exports,function(t){var n=e[s][1][t];return i(n?n:t)},f,f.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e){function n(t){if("object"==typeof t.key&&(t.data=t.key,t.key=void 0),t.key&&e.exports.instances[t.key])return e.exports.instances[t.key];var n=new r(t);return e.exports.instances[n.key]=n,n}var r=t("./src/structure");e.exports=function(t,e){return n({key:t,data:e})},e.exports.instances={},e.exports.withHistory=function(t,e){return n({key:t,data:e,history:!0})},e.exports.Structure=r,e.exports.clear=function(){e.exports.instances={}},e.exports.remove=function(t){return delete e.exports.instances[t]}},{"./src/structure":5}],2:[function(t,e){"use strict";function n(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function r(){}r.prototype._events=void 0,r.prototype.listeners=function(t){if(!this._events||!this._events[t])return[];if(this._events[t].fn)return[this._events[t].fn];for(var e=0,n=this._events[t].length,r=new Array(n);n>e;e++)r[e]=this._events[t][e].fn;return r},r.prototype.emit=function(t,e,n,r,i,o){if(!this._events||!this._events[t])return!1;var s,u,a=this._events[t],c=arguments.length;if("function"==typeof a.fn){switch(a.once&&this.removeListener(t,a.fn,!0),c){case 1:return a.fn.call(a.context),!0;case 2:return a.fn.call(a.context,e),!0;case 3:return a.fn.call(a.context,e,n),!0;case 4:return a.fn.call(a.context,e,n,r),!0;case 5:return a.fn.call(a.context,e,n,r,i),!0;case 6:return a.fn.call(a.context,e,n,r,i,o),!0}for(u=1,s=new Array(c-1);c>u;u++)s[u-1]=arguments[u];a.fn.apply(a.context,s)}else{var f,h=a.length;for(u=0;h>u;u++)switch(a[u].once&&this.removeListener(t,a[u].fn,!0),c){case 1:a[u].fn.call(a[u].context);break;case 2:a[u].fn.call(a[u].context,e);break;case 3:a[u].fn.call(a[u].context,e,n);break;default:if(!s)for(f=1,s=new Array(c-1);c>f;f++)s[f-1]=arguments[f];a[u].fn.apply(a[u].context,s)}}return!0},r.prototype.on=function(t,e,r){var i=new n(e,r||this);return this._events||(this._events={}),this._events[t]?this._events[t].fn?this._events[t]=[this._events[t],i]:this._events[t].push(i):this._events[t]=i,this},r.prototype.once=function(t,e,r){var i=new n(e,r||this,!0);return this._events||(this._events={}),this._events[t]?this._events[t].fn?this._events[t]=[this._events[t],i]:this._events[t].push(i):this._events[t]=i,this},r.prototype.removeListener=function(t,e,n){if(!this._events||!this._events[t])return this;var r=this._events[t],i=[];if(e&&(r.fn&&(r.fn!==e||n&&!r.once)&&i.push(r),!r.fn))for(var o=0,s=r.length;s>o;o++)(r[o].fn!==e||n&&!r[o].once)&&i.push(r[o]);return i.length?this._events[t]=1===i.length?i[0]:i:delete this._events[t],this},r.prototype.removeAllListeners=function(t){return this._events?(t?delete this._events[t]:this._events={},this):this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.EventEmitter=r,r.EventEmitter2=r,r.EventEmitter3=r,e.exports=r},{}],3:[function(t,e,n){function r(t,e,n){return 1===arguments.length?e=[]:"function"==typeof e?(n=e,e=[]):e=p(e),s(t,e,n)}function i(t,e,n,r){this.size=r,this._rootData=t,this._keyPath=e,this._onChange=n}function o(t,e,n,r){this.size=r,this._rootData=t,this._keyPath=e,this._onChange=n}function s(t,e,n,r){arguments.length<4&&(r=t.getIn(e));var s=r&&r.size,u=v.isIndexed(r)?o:i;return new u(t,e,n,s)}function u(t,e,n){return v.isIterable(n)?a(t,e,n):n}function a(t,e,n){return s(t._rootData,f(t._keyPath,e),t._onChange,n)}function c(t,e,n){var r=arguments.length>2,i=t._rootData.updateIn(t._keyPath,r?m():void 0,e),o=t._keyPath||[],u=t._onChange&&t._onChange.call(void 0,i,t._rootData,r?f(o,n):o);return void 0!==u&&(i=u),s(i,t._keyPath,t._onChange)}function f(t,e){return t.concat(h(e))}function h(t){return Array.isArray(t)?t:l.Iterable(t).toArray()}function p(t){return Array.isArray(t)?t:v.isIterable(t)?t.toArray():[t]}var l="undefined"!=typeof window?window.Immutable:"undefined"!=typeof global?global.Immutable:null,v=l.Iterable,y=v.Iterator,d=l.Seq,m=l.Map,_=Object.create(d.Keyed.prototype),g=Object.create(d.Indexed.prototype);_.constructor=i,g.constructor=o,_.toString=function(){return this.__toString("Cursor {","}")},g.toString=function(){return this.__toString("Cursor [","]")},_.deref=_.valueOf=g.deref=g.valueOf=function(t){return this._rootData.getIn(this._keyPath,t)},_.get=g.get=function(t,e){return this.getIn([t],e)},_.getIn=g.getIn=function(t,e){if(t=h(t),0===t.length)return this;var n=this._rootData.getIn(f(this._keyPath,t),I);return n===I?e:u(this,t,n)},g.set=_.set=function(t,e){return c(this,function(n){return n.set(t,e)},[t])},g.setIn=_.setIn=m.prototype.setIn,_.remove=_["delete"]=g.remove=g["delete"]=function(t){return c(this,function(e){return e.remove(t)},[t])},g.removeIn=g.deleteIn=_.removeIn=_.deleteIn=m.prototype.deleteIn,_.clear=g.clear=function(){return c(this,function(t){return t.clear()})},g.update=_.update=function(t,e,n){return 1===arguments.length?c(this,t):this.updateIn([t],e,n)},g.updateIn=_.updateIn=function(t,e,n){return c(this,function(r){return r.updateIn(t,e,n)},t)},g.merge=_.merge=function(){var t=arguments;return c(this,function(e){return e.merge.apply(e,t)})},g.mergeWith=_.mergeWith=function(){var t=arguments;return c(this,function(e){return e.mergeWith.apply(e,t)})},g.mergeIn=_.mergeIn=m.prototype.mergeIn,g.mergeDeep=_.mergeDeep=function(){var t=arguments;return c(this,function(e){return e.mergeDeep.apply(e,t)})},g.mergeDeepWith=_.mergeDeepWith=function(){var t=arguments;return c(this,function(e){return e.mergeDeepWith.apply(e,t)})},g.mergeDeepIn=_.mergeDeepIn=m.prototype.mergeDeepIn,_.withMutations=g.withMutations=function(t){return c(this,function(e){return(e||m()).withMutations(t)})},_.cursor=g.cursor=function(t){return t=p(t),0===t.length?this:a(this,t)},_.__iterate=g.__iterate=function(t,e){var n=this,r=n.deref();return r&&r.__iterate?r.__iterate(function(e,r){return t(u(n,[r],e),r,n)},e):0},_.__iterator=g.__iterator=function(t,e){var n=this.deref(),r=this,i=n&&n.__iterator&&n.__iterator(y.ENTRIES,e);return new y(function(){if(!i)return{value:void 0,done:!0};var e=i.next();if(e.done)return e;var n=e.value,o=n[0],s=u(r,[o],n[1]);return{value:t===y.KEYS?o:t===y.VALUES?s:[o,s],done:!1}})},i.prototype=_,o.prototype=g;var I={};n.from=r},{immutable:void 0}],4:[function(t,e){e.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],5:[function(t,e){(function(n){function r(t){return t=t||{},this instanceof r?(this.key=t.key||v.generateRandomKey(),this.current=t.data,a(this.current)&&this.current||(this.current=f.fromJS(this.current||{})),t.history&&(this.history=f.List.of(this.current),this._currentRevision=0),void p.call(this,arguments)):new r(t)}function i(t,e){return function(n,r){var i=e.apply(e,arguments);return t.history&&n!==r?(t.history=t.history.take(++t._currentRevision).push(t.current),i):i}}function o(t,e){return function(n,r,i){var o=e.apply(e,arguments);return n===r?o:(t.emit("swap",o,r,i),y(t,o,r,i),o)}}function s(t,e){return function(n,r,i){var o=e.apply(e,arguments);if(n===r)return o;var s=r&&r.getIn(i),a=o&&o.getIn(i),c=r&&u(r,i),f=o&&u(o,i);return c&&!f?t.emit("delete",i,s):c&&f?t.emit("change",i,a,s):!c&&f&&t.emit("add",i,a),o}}function u(t,e){return t.hasIn?t.hasIn(e):t.getIn(e,d)!==d}function a(t){return c("Iterable","isIterable",t)||c("Seq","isSeq",t)||c("Map","isMap",t)||c("OrderedMap","isOrderedMap",t)||c("List","isList",t)||c("Stack","isStack",t)||c("Set","isSet",t)}function c(t,e,n){return f[t]&&f[t][e]&&f[t][e](n)}var f="undefined"!=typeof window?window.Immutable:"undefined"!=typeof n?n.Immutable:null,h=t("immutable/contrib/cursor"),p=t("eventemitter3").EventEmitter,l=t("inherits"),v=t("./utils");l(r,p),e.exports=r,r.prototype.cursor=function(t){var e=this;if(t=t||[],!this.current)throw new Error("No structure loaded.");var n=function(t,n,r){return e.current=e.current===n?t:u(t,r)?e.current.setIn(r,t.getIn(r)):e.current.removeIn(r)};return n=i(this,n),n=o(this,n),n=s(this,n),h.from(e.current,t,n)},r.prototype.forceHasSwapped=function(t,e,n){this.emit("swap",t||this.current,e,n),y(this,t||this.current,e,n)},r.prototype.undo=function(t){return this._currentRevision-=t||1,this._currentRevision<0&&(this._currentRevision=0),this.current=this.history.get(this._currentRevision),this.current},r.prototype.redo=function(t){return this._currentRevision+=t||1,this._currentRevision>this.history.count()-1&&(this._currentRevision=this.history.count()-1),this.current=this.history.get(this._currentRevision),this.current},r.prototype.undoUntil=function(t){return this._currentRevision=this.history.indexOf(t),this.current=t,t};var y=function(){var t=!1;return"function"!=typeof requestAnimationFrame?function(){}:function(e,n,r){t||(t=!0,requestAnimationFrame(function(){t=!1,e.emit("next-animation-frame",n,r)}))}}(),d={}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./utils":6,eventemitter3:2,"immutable/contrib/cursor":3,inherits:4}],6:[function(t,e){e.exports.generateRandomKey=function(t){return t=t||10,Math.random().toString(36).substring(2).substring(0,t)}},{}]},{},[1])(1)});