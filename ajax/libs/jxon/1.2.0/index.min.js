!function(e){"undefined"==typeof e.DOMParser&&(e.DOMParser=require("xmldom").DOMParser,e.document={},e.document.implementation=new(require("xmldom").DOMImplementation));var t=new function(){function t(e){return m.test(e)?null:p.test(e)?"true"===e.toLowerCase():isFinite(e)?parseFloat(e):f&&isFinite(Date.parse(e))?new Date(e):e}function n(){}function r(e){return null===e?new n:e instanceof Object?e:new e.constructor(e)}function i(e,n,o,c){var f,m,p=d.length,h=e.hasChildNodes(),g=e.hasAttributes(),y=Boolean(2&n),T=0,x="",v=y?{}:!0;if(h)for(var b,S=0;S<e.childNodes.length;S++)b=e.childNodes.item(S),4===b.nodeType?x+=b.nodeValue:3===b.nodeType?x+=b.nodeValue.trim():1!==b.nodeType||b.prefix||d.push(b);var w=d.length,C=t(x);y||!h&&!g||(v=0===n?r(C):{});for(var N=p;w>N;N++)f=d[N].nodeName,l&&(f=f.toLowerCase()),m=i(d[N],n,o,c),v.hasOwnProperty(f)?(v[f].constructor!==Array&&(v[f]=[v[f]]),v[f].push(m)):(v[f]=m,T++);if(g){for(var O,D,M=e.attributes.length,X=c?"":u,j=c?{}:v,k=0;M>k;T++,k++)O=e.attributes.item(k),D=O.name,l&&(D=D.toLowerCase()),j[X+D]=t(O.value.trim());c&&(o&&Object.freeze(j),v[s]=j,T-=M-1)}return 3===n||(2===n||1===n&&T>0)&&x?v[a]=C:!y&&0===T&&x&&(v=C),o&&(y||T>0)&&Object.freeze(v),d.length=p,v}function o(e,t,n){var r,i;if(n.constructor===String||n.constructor===Number||n.constructor===Boolean){if(t.appendChild(e.createTextNode(n.toString())),n===n.valueOf())return}else n.constructor===Date&&t.appendChild(e.createTextNode(n.toGMTString()));for(var l in n)if(r=n[l],!(isFinite(l)||r instanceof Function))if(l===a)null!==r&&r!==!0&&t.appendChild(e.createTextNode(r.constructor===Date?r.toGMTString():String(r)));else if(l===s)for(var f in r)t.setAttribute(f,r[f]);else if(l.charAt(0)===u)t.setAttribute(l.slice(1),r);else if(r.constructor===Array)for(var d=0;d<r.length;d++)i=e.createElementNS(r[d]["@xmlns"]||t.namespaceURI,l),o(e,i,r[d]),t.appendChild(i);else i=e.createElementNS((r||{})["@xmlns"]||t.namespaceURI,l),r instanceof Object?o(e,i,r):null!==r&&r!==!0?i.appendChild(e.createTextNode(r.toString())):c||r!==!0||i.appendChild(e.createTextNode(r.toString())),t.appendChild(i)}var a="keyValue",s="keyAttributes",u="@",l=!0,c=!0,f=!0,d=[],m=/^\s*$/,p=/^(?:true|false)$/i;n.prototype.toString=function(){return"null"},n.prototype.valueOf=function(){return null},this.xmlToJs=this.build=function(e,t,n,r){var o=arguments.length>1&&"number"==typeof t?3&t:1;return i(e,o,n||!1,arguments.length>3?r:3===o)},this.jsToXml=this.unbuild=function(t,n,r,i){var a=e.document.implementation.createDocument(n||null,r||"",i||null);return o(a,a.documentElement||a,t),a},this.config=function(e){for(var t in e)switch(t){case"valueKey":a=e.valueKey;break;case"attrKey":s=e.attrKey;break;case"attrPrefix":u=e.attrPrefix;break;case"lowerCaseTags":l=e.lowerCaseTags;break;case"trueIsEmpty":c=e.trueIsEmpty;break;case"autoDate":f=e.autoDate}},this.stringToXml=function(t){return(new e.DOMParser).parseFromString(t,"application/xml")},this.xmlToString=function(t){return"undefined"!=typeof t.xml?t.xml:("undefined"==typeof e.XMLSerializer&&(e.XMLSerializer=require("xmldom").XMLSerializer),(new e.XMLSerializer).serializeToString(t))},this.stringToJs=function(e){var t=this.stringToXml(e);return"xml"===t.firstChild.tagName&&(t=t.documentElement),this.xmlToJs(t)},this.jsToString=this.stringify=function(e,t,n,r){return this.xmlToString(this.jsToXml(e,t,n,r))}};"undefined"!=typeof module?module.exports=t:"function"==typeof define&&define.amd?define(function(){return t}):e.JXON=t}("undefined"!=typeof window?window:this);