!function(e){"undefined"==typeof e.DOMParser&&(e.DOMParser=require("xmldom").DOMParser,e.document={},e.document.implementation=new(require("xmldom").DOMImplementation));var t=new function(){function t(e){return p.test(e)?null:h.test(e)?"true"===e.toLowerCase():isFinite(e)?parseFloat(e):f&&isFinite(Date.parse(e))?new Date(e):e}function n(){}function r(e){return null===e?new n:e instanceof Object?e:new e.constructor(e)}function i(e,n,o,c){var f,p,h=m.length,g=e.hasChildNodes(),y=e.nodeType===e.ELEMENT_NODE&&e.hasAttributes(),T=Boolean(2&n),x=0,b="",v=T?{}:!0;if(g)for(var S,w=0;w<e.childNodes.length;w++)S=e.childNodes.item(w),4===S.nodeType?b+=S.nodeValue:3===S.nodeType?b+=S.nodeValue.trim():1!==S.nodeType||d&&S.prefix||m.push(S);var N=m.length,O=t(b);T||!g&&!y||(v=0===n?r(O):{});for(var C=h;N>C;C++)f=m[C].nodeName,l&&(f=f.toLowerCase()),p=i(m[C],n,o,c),v.hasOwnProperty(f)?(v[f].constructor!==Array&&(v[f]=[v[f]]),v[f].push(p)):(v[f]=p,x++);if(y){for(var D,M,E=e.attributes.length,P=c?"":u,X=c?{}:v,k=0;E>k;x++,k++)D=e.attributes.item(k),M=D.name,l&&(M=M.toLowerCase()),X[P+M]=t(D.value.trim());c&&(o&&Object.freeze(X),v[s]=X,x-=E-1)}return 3===n||(2===n||1===n&&x>0)&&b?v[a]=O:!T&&0===x&&b&&(v=O),o&&(T||x>0)&&Object.freeze(v),m.length=h,v}function o(e,t,n){var r,i;if(n.constructor===String||n.constructor===Number||n.constructor===Boolean){if(t.appendChild(e.createTextNode(n.toString())),n===n.valueOf())return}else n.constructor===Date&&t.appendChild(e.createTextNode(n.toGMTString()));for(var l in n)if(r=n[l],!(isFinite(l)||r instanceof Function))if(l===a)null!==r&&r!==!0&&t.appendChild(e.createTextNode(r.constructor===Date?r.toGMTString():String(r)));else if(l===s)for(var f in r)t.setAttribute(f,r[f]);else if(l.charAt(0)===u)t.setAttribute(l.slice(1),r);else if(r.constructor===Array)for(var d=0;d<r.length;d++)i=e.createElementNS(r[d]["@xmlns"]||t.namespaceURI,l),o(e,i,r[d]),t.appendChild(i);else i=e.createElementNS((r||{})["@xmlns"]||t.namespaceURI,l),r instanceof Object?o(e,i,r):null!==r&&r!==!0?i.appendChild(e.createTextNode(r.toString())):c||r!==!0||i.appendChild(e.createTextNode(r.toString())),t.appendChild(i)}var a="keyValue",s="keyAttributes",u="@",l=!0,c=!0,f=!0,d=!1,m=[],p=/^\s*$/,h=/^(?:true|false)$/i;n.prototype.toString=function(){return"null"},n.prototype.valueOf=function(){return null},this.xmlToJs=this.build=function(e,t,n,r){var o=arguments.length>1&&"number"==typeof t?3&t:1;return i(e,o,n||!1,arguments.length>3?r:3===o)},this.jsToXml=this.unbuild=function(t,n,r,i){var a=e.document.implementation.createDocument(n||null,r||"",i||null);return o(a,a.documentElement||a,t),a},this.config=function(e){for(var t in e)switch(t){case"valueKey":a=e.valueKey;break;case"attrKey":s=e.attrKey;break;case"attrPrefix":u=e.attrPrefix;break;case"lowerCaseTags":l=e.lowerCaseTags;break;case"trueIsEmpty":c=e.trueIsEmpty;break;case"autoDate":f=e.autoDate;break;case"ignorePrefixedNodes":d=e.ignorePrefixedNodes}},this.stringToXml=function(t){return(new e.DOMParser).parseFromString(t,"application/xml")},this.xmlToString=function(t){return"undefined"!=typeof t.xml?t.xml:("undefined"==typeof e.XMLSerializer&&(e.XMLSerializer=require("xmldom").XMLSerializer),(new e.XMLSerializer).serializeToString(t))},this.stringToJs=function(e){var t=this.stringToXml(e);return this.xmlToJs(t)},this.jsToString=this.stringify=function(e,t,n,r){return this.xmlToString(this.jsToXml(e,t,n,r))}};"undefined"!=typeof module?module.exports=t:"function"==typeof define&&define.amd?define(function(){return t}):e.JXON=t}("undefined"!=typeof window?window:this);