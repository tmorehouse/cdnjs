(function(){var n,r,e,t,u,i,o,c,l,s,a,f,p,v=[].slice;c=require("querystring"),s=require("url").resolve,p=require("fairmont"),i=p.include,t=p.clone,f=p.type,e=p.base64,o=require("typely").overload,r=require("evie"),l=require("./request").request,n={basic:function(n){var r,t;return t=n.username,r=n.password,"Basic "+e(""+t+":"+r)}},u=function(n){var r,e,t;t={};for(e in n)r=n[e],"function"!==f(r)&&(t[e]=r);return t},a=o(function(e){return e("string",function(n){return a({url:n})}),e("string","object",function(n,r){return a({url:n,description:r})}),e("object",function(e){var c,p,d,b,g,q,h,j,m;j=e.url,d=e.events,p=e.description,g=function(n,r){return null==r&&(r=u(p)),a({url:s(j,n),events:d.source(),description:r})},b=function(){var n;return n=require("url-template").parse(j),function(r,e){return null==e&&(e=p),a({url:n.expand(r),events:d.source(),description:e})}}(),q=function(r){var e;return null==r.events&&(r.events=d),null==r.url&&(r.url=j),null==r.headers&&(r.headers={}),e=function(){return l.apply(null,[r].concat(v.call(arguments)))},e.invoke=function(){return e.apply(null,arguments)},i(e,{authorize:function(e){var u,i,o,c;return i=Object.keys(e)[0],o=n[i],u=o(e[i]),c=t(r),c.headers.authorization=u,q(c)}}),e},null==d&&(d=new r),m=o(function(n){return n("string",function(n){return g(n)}),n("string","object",function(n,r){return g(n,r)}),n("object",function(n){return b(n)}),n("object","object",function(n,r){return b(n,r)})}),m.on=function(){var n;return n=1<=arguments.length?v.call(arguments,0):[],d.on.apply(d,n),m};for(h in p)c=p[h],m[h]=function(){switch(f(c)){case"object":return q(t(c));case"function":return c(m)}}();return m})}),module.exports={resource:a}}).call(this);