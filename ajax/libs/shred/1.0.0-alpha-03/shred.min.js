(function(){var n,r,e,t,u,i,o,c,l,s,a,f,p,v=[].slice;o=require("querystring"),l=require("url").resolve,p=require("fairmont"),u=p.include,t=p.clone,f=p.type,e=p.base64,i=require("typely").overload,r=require("mutual").EventChannel,c=require("./request").request,a=function(n,r){return r(n),n},n={basic:function(n){var r,t;return t=n.username,r=n.password,"Basic "+e(""+t+":"+r)}},s=i(function(e){return e("string",function(n){return s({url:n})}),e("string","object",function(n,r){return s({url:n,description:r})}),e("object",function(e){var o,a,p,d,b,g,q,h,m;h=e.url,p=e.events,a=e.description,b=function(n,r){return s({url:l(h,n),events:p.source(),description:r})},d=function(){var n;return n=require("url-template").parse(h),function(r,e){return null==e&&(e=a),s({url:n.expand(r),events:p.source(),description:e})}}(),g=function(r){var e;return null==r.events&&(r.events=p),null==r.url&&(r.url=h),null==r.headers&&(r.headers={}),e=function(){return c.apply(null,[r].concat(v.call(arguments)))},e.invoke=function(){return e.apply(null,arguments)},u(e,{authorize:function(e){var u,i,o,c;return i=Object.keys(e)[0],o=n[i],u=o(e[i]),c=t(r),c.headers.authorization=u,g(c)}}),e},null==p&&(p=new r),m=i(function(n){return n("string",function(n){return b(n)}),n("string","object",function(n,r){return b(n,r)}),n("object",function(n){return d(n)}),n("object","object",function(n,r){return d(n,r)})}),m.on=function(){var n;return n=1<=arguments.length?v.call(arguments,0):[],p.on.apply(p,n),m};for(q in a)o=a[q],m[q]=function(){switch(f(o)){case"object":return g(t(o));case"function":return o(m)}}();return m})}),module.exports={resource:s}}).call(this);