!function(t){"use strict";function i(t,i){var e=t.create("masonry");return e.prototype._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns();var t=this.cols;for(this.colYs=[];t--;)this.colYs.push(0);this.maxY=0},e.prototype.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var t=this.items[0],o=t&&t.element;this.columnWidth=o&&i(o).outerWidth||this.containerWidth}this.columnWidth+=this.gutter,this.cols=Math.floor((this.containerWidth+this.gutter)/this.columnWidth),this.cols=Math.max(this.cols,1)},e.prototype.getContainerWidth=function(){var t=this.options.isFitWidth?this.element.parentNode:this.element,o=i(t);this.containerWidth=o&&o.innerWidth},e.prototype._getItemLayoutPosition=function(t){t.getSize();var i=Math.ceil(t.size.outerWidth/this.columnWidth);i=Math.min(i,this.cols);for(var e=this._getColGroup(i),h=Math.min.apply(Math,e),s=o(e,h),n={x:this.columnWidth*s,y:h},r=h+t.size.outerHeight,a=this.cols+1-e.length,u=0;a>u;u++)this.colYs[s+u]=r;return n},e.prototype._getColGroup=function(t){if(2>t)return this.colYs;for(var i=[],o=this.cols+1-t,e=0;o>e;e++){var h=this.colYs.slice(e,e+t);i[e]=Math.max.apply(Math,h)}return i},e.prototype._manageStamp=function(t){var o=i(t),e=this._getElementOffset(t),h=this.options.isOriginLeft?e.left:e.right,s=h+o.outerWidth,n=Math.floor(h/this.columnWidth);n=Math.max(0,n);var r=Math.floor(s/this.columnWidth);r=Math.min(this.cols-1,r);for(var a=(this.options.isOriginTop?e.top:e.bottom)+o.outerHeight,u=n;r>=u;u++)this.colYs[u]=Math.max(a,this.colYs[u])},e.prototype._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var t={height:this.maxY};return this.options.isFitWidth&&(t.width=this._getContainerFitWidth()),t},e.prototype._getContainerFitWidth=function(){for(var t=0,i=this.cols;--i&&0===this.colYs[i];)t++;return(this.cols-t)*this.columnWidth-this.gutter},e.prototype.resize=function(){var t=this.containerWidth;this.getContainerWidth(),t!==this.containerWidth&&this.layout()},e}var o=Array.prototype.indexOf?function(t,i){return t.indexOf(i)}:function(t,i){for(var o=0,e=t.length;e>o;o++){var h=t[o];if(h===i)return o}return-1};"function"==typeof define&&define.amd?define(["outlayer/outlayer","get-size/get-size"],i):t.Masonry=i(t.Outlayer,t.getSize)}(window);