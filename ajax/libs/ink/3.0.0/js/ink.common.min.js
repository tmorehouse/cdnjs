Ink.createModule("Ink.UI.Common","1",["Ink.Dom.Element_1","Ink.Net.Ajax_1","Ink.Dom.Css_1","Ink.Dom.Selector_1","Ink.Util.Url_1"],function(e,t,n,r,o){"use strict";var i={},s=0,a={},u=Object.keys||function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},c={Layouts:{TINY:"tiny",SMALL:"small",MEDIUM:"medium",LARGE:"large",XLARGE:"xlarge"},isDOMElement:function(e){return e&&"object"==typeof e&&"nodeType"in e&&1===e.nodeType},isInteger:function(e){return"number"==typeof e&&e%1===0},elOrSelector:function(e,t){if(!this.isDOMElement(e)){var n=r.select(e);return 0===n.length?(Ink.warn(t+" must either be a DOM Element or a selector expression!\nThe script element must also be after the DOM Element itself."),null):n[0]}return e},elsOrSelector:function(e,t,n){var o;if("string"==typeof e?o=r.select(e):c.isDOMElement(e)?o=[e]:e&&"object"==typeof e&&"number"==typeof e.length&&(o=e),o&&o.length)return o;if(n||2===arguments.length)throw new TypeError(t+" must either be a DOM Element, an Array of elements, or a selector expression!\nThe script element must also be after the DOM Element itself.");return[]},options:function(t,n,r,o){function i(e){return l=n[e][0],f=l.toLowerCase(),m=2===n[e].length?n[e][1]:a,l||y("Ink.UI.Common.options: Always specify a type!"),f in c._coerce_funcs||y("Ink.UI.Common.options: "+n[e][0]+" is not a valid type. Use one of "+u(c._coerce_funcs).join(", ")),(!n[e].length||n[e].length>2)&&y('the "defaults" argument must be an object mapping option names to [typestring, optional] arrays.'),s=e in p?c._coerce_from_string(f,p[e],e,t):a,s!==a?c._options_validate(s,f)?s:(_("("+e+" option) Invalid "+f+" "+g(s)),m):e in r?r[e]:m!==a?m:void y("Option "+e+" is required!")}"string"!=typeof t&&(o=r,r=n,n=t,t=""),r=r||{};var s,l,f,m,d={},p=o?e.data(o):{},h=function(e){return t&&(e=t+': "'+(""+e).replace(/"/,'\\"')+'"'),e},g=function(e){return'"'+(""+e).replace(/"/,'\\"')+'"'},y=function(e){throw new Error(h(e))},_=function(e){Ink.error(h(e)+". Ignoring option.")};for(var v in n)n.hasOwnProperty(v)&&(d[v]=i(v));return d},_coerce_from_string:function(e,t,n,r){return e in c._coerce_funcs?c._coerce_funcs[e](t,n,r):t},_options_validate:function(e,t){return t in c._options_validate_types?c._options_validate_types[t].call(c,e):!1},_coerce_funcs:function(){var e={element:function(e){return c.elOrSelector(e,"")},elements:function(e){return c.elsOrSelector(e,"",!1)},object:function(e){return e},number:function(e){return parseFloat(e)},"boolean":function(e){return!("false"===e||""===e||null===e)},string:function(e){return e},"function":function(e,t,n){return Ink.error(n+': You cannot specify the option "'+t+"\" through data-attributes because it's a function"),a}};return e["float"]=e.integer=e.number,e}(),_options_validate_types:function(){var e={string:function(e){return"string"==typeof e},number:function(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)},integer:function(e){return e===Math.round(e)},element:function(e){return c.isDOMElement(e)},elements:function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&e.length},"boolean":function(e){return"boolean"==typeof e}};return e["float"]=e.number,e}(),clone:function(e){try{return JSON.parse(JSON.stringify(e))}catch(t){throw new Error("Given object cannot have loops!")}},childIndex:function(e){if(c.isDOMElement(e))for(var t=r.select("> *",e.parentNode),n=0,o=t.length;o>n;++n)if(t[n]===e)return n;throw"not found!"},ajaxJSON:function(e,n,r){new t(e,{evalJS:"force",method:"POST",parameters:n,onSuccess:function(e){try{if(e=e.responseJSON,"ok"!==e.status)throw"server error: "+e.message;r(null,e)}catch(t){r(t)}},onFailure:function(){r("communication failure")}})},currentLayout:function(){var e,t,o,i,s,a=r.select("#ink-layout-detector")[0];if(!a){a=document.createElement("div"),a.id="ink-layout-detector";for(o in this.Layouts)this.Layouts.hasOwnProperty(o)&&(i=this.Layouts[o],s=document.createElement("div"),s.className="show-"+i+" hide-all",s.setAttribute("data-ink-layout",i),a.appendChild(s));document.body.appendChild(a)}var u="",c=0;for(e=0,t=a.childNodes.length;t>e;++e)s=a.childNodes[e],"block"===n.getStyle(s,"display")&&(u=s.getAttribute("data-ink-layout"),c+=1);return 1===c?u:"large"},hashSet:function(e){if("object"!=typeof e)throw new TypeError("o should be an object!");var t=o.getAnchorString();t=Ink.extendObj(t,e),window.location.hash=o.genQueryString("",t).substring(1)},cleanChildren:function(e){if(!c.isDOMElement(e))throw"Please provide a valid DOMElement";for(var t,n=e.lastChild;n;)t=n.previousSibling,e.removeChild(n),n=t},storeIdAndClasses:function(e,t){if(!c.isDOMElement(e))throw"Please provide a valid DOMElement as first parameter";var n=e.id;n&&(t._id=n);var r=e.className;r&&(t._classes=r)},restoreIdAndClasses:function(e,t){if(!c.isDOMElement(e))throw"Please provide a valid DOMElement as first parameter";t._id&&e.id!==t._id&&(e.id=t._id),t._classes&&-1===e.className.indexOf(t._classes)&&(e.className?e.className+=" "+t._classes:e.className=t._classes),t._instanceId&&!e.getAttribute("data-instance")&&e.setAttribute("data-instance",t._instanceId)},registerInstance:function(e,t,n){if(!e._instanceId){if("object"!=typeof e)throw new TypeError("1st argument must be a JavaScript object!");if(!e._options||!e._options.skipRegister){if(!this.isDOMElement(t))throw new TypeError("2nd argument must be a DOM element!");if(void 0!==n&&"string"!=typeof n)throw new TypeError("3rd argument must be a string!");var r=(n||"instance")+ ++s;i[r]=e,e._instanceId=r;var o=t.getAttribute("data-instance");o=null!==o?[o,r].join(" "):r,t.setAttribute("data-instance",o)}}},unregisterInstance:function(e){delete i[e]},getInstance:function(e){var t;if(this.isDOMElement(e)){if(t=e.getAttribute("data-instance"),null===t)throw new Error("argument is not a DOM instance element!")}else t=e;t=t.split(" ");var n,r,o,s=t.length,a=[];for(o=0;s>o;++o){if(r=t[o],!r)throw new Error("Element is not a JS instance!");if(n=i[r],!n)throw new Error('Instance "'+r+'" not found!');a.push(n)}return 1===s?a[0]:a},getInstanceFromSelector:function(e){var t=r.select(e)[0];if(!t)throw new Error("Element not found!");return this.getInstance(t)},getInstanceIds:function(){var e=[];for(var t in i)i.hasOwnProperty(t)&&e.push(t);return e},getInstances:function(){var e=[];for(var t in i)i.hasOwnProperty(t)&&e.push(i[t]);return e},destroyComponent:function(){c.unregisterInstance(this._instanceId),this._element.parentNode.removeChild(this._element)}};return c});