Ink.createModule("Ink.UI.Stacker",1,["Ink.UI.Common_1","Ink.Dom.Event_1","Ink.Dom.Element_1"],function(t,o,i){"use strict";function s(t,o){this._init(t,o)}return s.prototype={_init:function(o,i){this._rootElm=t.elsOrSelector(o,"Ink.UI.Stacker root element")[0]||null,null===this._rootElm&&"undefined"!=typeof console&&console.warn("Ink.UI.Stacker: No root element"),this._options=t.options({column:["String",".stacker-column"],item:["String",".stacker-item"],customBreakPoints:["Object",null],largeMax:["Number",Number.MAX_VALUE],largeMin:["Number",961],mediumMax:["Number",960],mediumMin:["Number",651],smallMax:["Number",650],smallMin:["Number",0],largeCols:["Integer",3],mediumCols:["Integer",2],smallCols:["Integer",1],isOrdered:["Boolean",!0],onRunCallback:["Function",null],onResizeCallback:["Function",null],onAPIReloadCallback:["Function",null]},i||{},this._rootElm),this._aList=[],this._curLayout="large",this._runFirstTime=!1,this._getPageItemsToList(),(this._canApplyLayoutChange()||!this._runFirstTime)&&(this._runFirstTime=!0,this._applyLayoutChange(),"function"==typeof this._options.onRunCallback&&this._options.onRunCallback(this._curLayout)),this._addEvents()},addItem:function(t){this._aList.push(t)},reloadItems:function(){this._applyLayoutChange(),"function"==typeof this._options.onAPIReloadCallback&&this._options.onAPIReloadCallback(this._curLayout)},_addEvents:function(){o.observe(window,"resize",Ink.bindEvent(this._onResize,this))},_onResize:function(){this._canApplyLayoutChange()&&(this._removeDomItems(),this._applyLayoutChange(),"function"==typeof this._options.onResizeCallback&&this._options.onResizeCallback(this._curLayout))},_setCurLayout:function(){var t=i.viewportWidth();if(this._options.customBreakpoints&&"object"==typeof this._options.customBreakPoints){for(var o in this._options.customBreakPoints)if(this._options.customBreakPoints.hasOwnProperty(o)&&t>=Number(this._options.customBreakPoints[o].min)&&t<=Number(this._options.customBreakPoints[o].max)&&this._curLayout!==o)return void(this._curLayout=o)}else t<=Number(this._options.largeMax)&&t>=Number(this._options.largeMin)&&"large"!==this._curLayout?this._curLayout="large":t>=Number(this._options.mediumMin)&&t<=Number(this._options.mediumMax)&&"medium"!==this._curLayout?this._curLayout="medium":t>=Number(this._options.smallMin)&&t<=Number(this._options.smallMax)&&"small"!==this._curLayout&&(this._curLayout="small")},_getColumnsToShow:function(){return Number(this._options.customBreakPoints&&"object"==typeof this._options.customBreakPoints?this._options.customBreakPoints[this._curLayout].cols:this._options[this._curLayout+"Cols"])},_canApplyLayoutChange:function(){var t=this._curLayout;return this._setCurLayout(),t!==this._curLayout?!0:!1},_getPageItemsToList:function(){this._aColumn=Ink.ss(this._options.column,this._rootElm);var t=this._aColumn.length,o=0;if(t>0){for(var i=0;i<this._aColumn.length;i++)for(var s=Ink.ss(this._options.item,this._aColumn[i]),n=0;n<s.length;n++)this._options.isOrdered&&(o=i+n*t),this._aList[o]=s[n],this._options.isOrdered||o++,s[n].parentNode.removeChild(s[n]);if(this._aList.length>0&&this._options.isOrdered){for(var e=[],a=0;a<this._aList.length;a++)"undefined"!=typeof this._aList[a]&&e.push(this._aList[a]);this._aList=e}}},_removeDomItems:function(){var t=this._aColumn.length;if(t>0)for(var o=0;t>o;o++)for(var i=Ink.ss(this._options.item,this._aColumn[o]),s=i.length-1;s>=0;s--)i[s].parentNode.removeChild(i[s])},_applyLayoutChange:function(){var t=this._getColumnsToShow(),o=this._aList.length,i=0,s=0;if(t>0)for(;t>s;){if(this._aColumn[s].appendChild(this._aList[i]),i++,s++,i===o)return;s===t&&(s=0)}}},s});